<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jornal do Aluno: Análise de Manchetes</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Playfair+Display:wght@700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap');

        :root {
            --verbo-cor: #007bff;
            --substantivo-cor: #28a745;
            --adjetivo-cor: #ffc107;
            --texto-manchete-cor: #343a40;
            --papel-claro: #fcf8e3;
            --papel-escuro: #e0d8c3;
            --borda-jornal: #6c757d;
        }

        *, *::before, *::after { box-sizing: border-box; }

        html, body {
            margin: 0; padding: 0;
            height: 100%; width: 100%;
            overflow: hidden;
            font-family: 'Merriweather', serif;
            background-color: #f8f9fa;
            color: var(--texto-manchete-cor);
        }

        .container {
            display: flex; justify-content: center; align-items: center;
            height: 100vh; padding: 20px;
        }

        .game-card, .report-screen {
            background-color: var(--papel-claro);
            border: 2px solid var(--borda-jornal);
            border-radius: 5px;
            box-shadow: 10px 10px 0px var(--papel-escuro), 0 0 15px rgba(0,0,0,0.1);
            width: 100%; max-width: 950px; height: 95vh;
            display: flex; flex-direction: column;
            overflow: hidden; padding: 30px 50px;
            position: relative;
        }

        .game-card::before, .report-screen::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4" viewBox="0 0 4 4"><rect fill="%23d6d0c4" width="1" height="1"/><rect fill="%23d6d0c4" x="2" y="2" width="1" height="1"/><rect fill="%23d6d0c4" x="1" y="1" width="1" height="1"/><rect fill="%23d6d0c4" x="3" y="3" width="1" height="1"/></svg>') repeat;
            opacity: 0.3;
            pointer-events: none;
        }

        header { text-align: center; padding-bottom: 25px; border-bottom: 2px solid var(--borda-jornal); margin-bottom: 25px; }
        h1 { 
            margin: 0; font-family: 'Playfair Display', serif; 
            font-size: 2.8em; font-weight: 700; color: var(--texto-manchete-cor);
            line-height: 1.1;
        }
        #ficha-counter { font-family: 'Roboto Mono', monospace; font-size: 0.9em; color: var(--borda-jornal); margin-top: 10px; }

        .progress-bar-container { width: 100%; height: 6px; background-color: var(--papel-escuro); border-radius: 3px; margin-top: 15px; overflow: hidden; }
        #progress-bar { width: 0%; height: 100%; background: linear-gradient(90deg, var(--verbo-cor), var(--substantivo-cor), var(--adjetivo-cor)); border-radius: 3px; transition: width 0.5s cubic-bezier(0.25, 1, 0.5, 1); }

        main { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .ficha { display: none; text-align: center; width: 100%; }
        .ficha.active { display: block; animation: fadeIn 0.6s cubic-bezier(0.25, 1, 0.5, 1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .instruction { font-size: 1.1em; color: var(--borda-jornal); margin-bottom: 30px; }
        .sentence { 
            font-family: 'Playfair Display', serif; font-size: 2.5em; line-height: 1.4; 
            font-weight: 700; color: var(--texto-manchete-cor);
            margin-bottom: 40px; text-transform: uppercase;
        }
        
        .word { 
            padding: 2px 8px; border-radius: 3px; cursor: pointer; transition: all 0.3s ease; 
            border-bottom: 2px dotted var(--borda-jornal);
        }
        .word.selected { background-color: rgba(0,0,0,0.1); }
        .word.classified { cursor: default; border-bottom: none; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); }

        .word.classified.verbo { background-color: var(--verbo-cor); }
        .word.classified.substantivo { background-color: var(--substantivo-cor); }
        .word.classified.adjetivo { background-color: var(--adjetivo-cor); color: var(--texto-manchete-cor); }

        #classification-box {
            position: absolute; display: none; gap: 10px; padding: 8px;
            background: rgba(0, 0, 0, 0.8); border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px; transform: translate(-50%, 15px) scale(0.95);
            backdrop-filter: blur(3px); transition: opacity 0.3s, transform 0.3s;
            z-index: 100;
        }
        .class-btn {
            border: none; border-radius: 5px; padding: 8px 15px; font-size: 0.9em;
            font-weight: 700; cursor: pointer; color: #fff; display: flex;
            align-items: center; gap: 6px; transition: transform 0.2s;
            font-family: 'Roboto Mono', monospace;
        }
        .class-btn:hover { transform: translateY(-2px); }
        .btn-verbo { background-color: var(--verbo-cor); }
        .btn-substantivo { background-color: var(--substantivo-cor); }
        .btn-adjetivo { background-color: var(--adjetivo-cor); color: var(--texto-manchete-cor); }

        footer { padding-top: 25px; text-align: center; border-top: 1px dashed var(--borda-jornal); margin-top: 25px; }
        .btn-avancar {
            background-color: var(--texto-manchete-cor); color: var(--papel-claro); 
            padding: 12px 40px; border: none; border-radius: 3px; font-size: 1.1em;
            font-weight: 700; cursor: pointer; transition: all 0.3s ease;
            font-family: 'Playfair Display', serif; text-transform: uppercase;
        }
        .btn-avancar:disabled { background-color: var(--borda-jornal); cursor: not-allowed; opacity: 0.7; }
        .btn-avancar:not(:disabled):hover { transform: scale(1.03); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        
        .report-screen { display: none; }
        .report-content { overflow-y: auto; flex-grow: 1; padding-right: 15px; }
        .report-content h2 { 
            text-align: center; font-family: 'Playfair Display', serif; font-size: 1.8em; 
            border-bottom: 1px solid var(--borda-jornal); padding-bottom: 10px; margin-bottom: 20px; 
        }
        
        #results-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; font-size: 1em; }
        #results-table th, #results-table td { padding: 10px; text-align: center; border: 1px solid var(--borda-jornal); }
        #results-table th { background-color: var(--papel-escuro); }
        .acertos { color: #28a745; font-weight: bold; }
        .erros { color: #dc3545; font-weight: bold; }

        .review-item { margin-bottom: 25px; background-color: rgba(0,0,0,0.05); padding: 15px; border-radius: 3px; border: 1px solid var(--papel-escuro); }
        .review-item .sentence { font-size: 1.8em; margin-bottom: 10px; font-family: 'Playfair Display', serif; }
        .review-item .explanation { font-size: 0.9em; color: var(--borda-jornal); text-align: left; margin-top: 10px; border-top: 1px dashed var(--papel-escuro); padding-top: 10px; }
        .review-item .explanation strong { color: var(--texto-manchete-cor); }

        .report-content::-webkit-scrollbar { width: 8px; }
        .report-content::-webkit-scrollbar-track { background: var(--papel-escuro); }
        .report-content::-webkit-scrollbar-thumb { background: var(--borda-jornal); }
    </style>
</head>
<body>

    <div class="container">
        <div class="game-card" id="game-container">
            <header>
                <h1>Jornal do Aluno</h1>
                <p id="ficha-counter"></p>
                <div class="progress-bar-container"><div id="progress-bar"></div></div>
            </header>
            <main id="fichas-container"></main>
            <footer>
                <button id="btn-avancar" class="btn-avancar" disabled>PRÓXIMA MANCHETE</button>
            </footer>
        </div>
        <div class="report-screen" id="report-container">
            <header><h1>Relatório da Redação</h1></header>
            <div class="report-content">
                <h2>Painel de Resultados</h2>
                <table id="results-table">
                    <thead><tr><th>Classe Gramatical</th><th>Acertos</th><th>Erros</th></tr></thead>
                    <tbody></tbody>
                </table>
                <h2>Gabarito Comentado</h2>
                <div id="review-list"></div>
            </div>
        </div>
    </div>
    
    <div id="classification-box">
        <button class="class-btn btn-verbo" data-type="verbo"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg> Verbo</button>
        <button class="class-btn btn-substantivo" data-type="substantivo"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg> Substantivo</button>
        <button class="class-btn btn-adjetivo" data-type="adjetivo"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2z"></path></svg> Adjetivo</button>
    </div>

    <script>
        const fichasData = [
            {
                sentence: "Amazônia sofre com recorde de desmatamento.",
                words: { "Amazônia": "substantivo", "sofre": "verbo", "recorde": "substantivo", "desmatamento": "substantivo" },
                explanation: "Nesta manchete: '<strong>sofre</strong>' é o verbo (a ação de sofrer). '<strong>Amazônia</strong>' e '<strong>desmatamento</strong>' são substantivos (nomes de um lugar e de um fenômeno). '<strong>Recorde</strong>' é um substantivo que qualifica o desmatamento."
            },
            {
                sentence: "Crise hídrica afeta regiões do Nordeste brasileiro.",
                words: { "Crise": "substantivo", "hídrica": "adjetivo", "afeta": "verbo", "regiões": "substantivo", "Nordeste": "substantivo", "brasileiro": "adjetivo" },
                explanation: "Aqui: '<strong>afeta</strong>' é o verbo (a ação de afetar). '<strong>Crise</strong>', '<strong>regiões</strong>' e '<strong>Nordeste</strong>' são substantivos. '<strong>Hídrica</strong>' e '<strong>brasileiro</strong>' são adjetivos que dão características."
            },
            {
                sentence: "Guerra na Ucrânia gera crise global de alimentos.",
                words: { "Guerra": "substantivo", "Ucrânia": "substantivo", "gera": "verbo", "crise": "substantivo", "global": "adjetivo", "alimentos": "substantivo" },
                explanation: "Observe: '<strong>gera</strong>' é o verbo (a ação de gerar). '<strong>Guerra</strong>', '<strong>Ucrânia</strong>', '<strong>crise</strong>' e '<strong>alimentos</strong>' são substantivos. '<strong>Global</strong>' é um adjetivo que qualifica a crise."
            },
            {
                sentence: "Inteligência artificial revoluciona diversos setores.",
                words: { "Inteligência": "substantivo", "artificial": "adjetivo", "revoluciona": "verbo", "setores": "substantivo", "diversos": "adjetivo"},
                explanation: "Nesta frase: '<strong>revoluciona</strong>' é a ação (verbo). '<strong>Inteligência</strong>' e '<strong>setores</strong>' são substantivos. '<strong>Artificial</strong>' e '<strong>diversos</strong>' são adjetivos que dão características."
            },
            {
                sentence: "Pandemia de Covid-19 transformou o mundo inteiro.",
                words: { "Pandemia": "substantivo", "Covid-19": "substantivo", "transformou": "verbo", "mundo": "substantivo", "inteiro": "adjetivo"},
                explanation: "A ação é '<strong>transformou</strong>' (verbo). '<strong>Pandemia</strong>', '<strong>Covid-19</strong>' e '<strong>mundo</strong>' são substantivos. '<strong>Inteiro</strong>' é um adjetivo que qualifica o mundo."
            },
            {
                sentence: "Explosão em Beirute chocou o planeta.",
                words: { "Explosão": "substantivo", "Beirute": "substantivo", "chocou": "verbo", "planeta": "substantivo" },
                explanation: "Note: '<strong>chocou</strong>' é o verbo. '<strong>Explosão</strong>', '<strong>Beirute</strong>' e '<strong>planeta</strong>' são substantivos (nomes de um evento, lugar e objeto)."
            },
            {
                sentence: "Queimadas recordes ameaçam o Pantanal brasileiro.",
                words: { "Queimadas": "substantivo", "recordes": "adjetivo", "ameaçam": "verbo", "Pantanal": "substantivo", "brasileiro": "adjetivo" },
                explanation: "A ação é '<strong>ameaçam</strong>' (verbo). '<strong>Queimadas</strong>' e '<strong>Pantanal</strong>' são substantivos. '<strong>Recordes</strong>' e '<strong>brasileiro</strong>' são adjetivos."
            },
            {
                sentence: "Novas tecnologias prometem futuro sustentável.",
                words: { "Novas": "adjetivo", "tecnologias": "substantivo", "prometem": "verbo", "futuro": "substantivo", "sustentável": "adjetivo" },
                explanation: "Aqui: '<strong>prometem</strong>' é o verbo. '<strong>Tecnologias</strong>' e '<strong>futuro</strong>' são substantivos. '<strong>Novas</strong>' e '<strong>sustentável</strong>' são adjetivos."
            },
            {
                sentence: "Mulheres ativistas lideram grandes movimentos sociais.",
                words: { "Mulheres": "substantivo", "ativistas": "adjetivo", "lideram": "verbo", "movimentos": "substantivo", "sociais": "adjetivo", "grandes": "adjetivo" },
                explanation: "Nesta frase: '<strong>lideram</strong>' é a ação (verbo). '<strong>Mulheres</strong>' e '<strong>movimentos</strong>' são substantivos. '<strong>Ativistas</strong>', '<strong>grandes</strong>' e '<strong>sociais</strong>' são adjetivos."
            },
            {
                sentence: "Vacinação em massa combate vírus mortal.",
                words: { "Vacinação": "substantivo", "massa": "substantivo", "combate": "verbo", "vírus": "substantivo", "mortal": "adjetivo" },
                explanation: "A ação é '<strong>combate</strong>' (verbo). '<strong>Vacinação</strong>', '<strong>massa</strong>' e '<strong>vírus</strong>' são substantivos. '<strong>Mortal</strong>' é um adjetivo que qualifica o vírus."
            }
        ];

        let reportData = [];
        let currentFichaIndex = 0;
        let attemptedWordsCount = 0;
        let totalWordsToClassify = 0;
        let selectedWordEl = null;

        const gameContainer = document.getElementById('game-container');
        const fichasContainer = gameContainer.querySelector('#fichas-container');
        const btnAvancar = gameContainer.querySelector('#btn-avancar');
        const progressBar = gameContainer.querySelector('#progress-bar');
        const fichaCounter = gameContainer.querySelector('#ficha-counter');
        const classificationBox = document.getElementById('classification-box');

        function renderFicha(index) {
            const ficha = fichasData[index];
            attemptedWordsCount = 0;
            totalWordsToClassify = Object.keys(ficha.words).length;
            btnAvancar.disabled = true;

            const sentenceEl = document.createElement('p');
            sentenceEl.classList.add('sentence');

            ficha.sentence.split(' ').forEach(wordText => {
                const cleanWord = wordText.replace(/[.,]/g, '');
                const span = document.createElement('span');
                span.textContent = wordText + ' ';
                
                if (ficha.words[cleanWord]) {
                    span.classList.add('word');
                    span.dataset.correctType = ficha.words[cleanWord];
                    span.addEventListener('click', handleWordClick);
                }
                sentenceEl.appendChild(span);
            });

            const fichaEl = document.createElement('div');
            fichaEl.classList.add('ficha');
            fichaEl.innerHTML = `<p class="instruction">Clique nas palavras destacadas e classifique-as.</p>`;
            fichaEl.appendChild(sentenceEl);

            fichasContainer.innerHTML = '';
            fichasContainer.appendChild(fichaEl);
            setTimeout(() => fichaEl.classList.add('active'), 10);
            
            progressBar.style.width = `${(index / fichasData.length) * 100}%`;
            fichaCounter.textContent = `Manchete ${index + 1} de ${fichasData.length}`;
        }

        function handleWordClick(event) {
            const target = event.target;
            if (target.classList.contains('classified')) return;
            if(selectedWordEl) selectedWordEl.classList.remove('selected');
            
            selectedWordEl = target;
            selectedWordEl.classList.add('selected');

            const wordRect = selectedWordEl.getBoundingClientRect();
            classificationBox.style.display = 'flex';
            classificationBox.style.opacity = '0';
            classificationBox.style.transform = 'translate(-50%, 15px) scale(0.95)';
            classificationBox.style.left = `${wordRect.left + wordRect.width / 2}px`;
            classificationBox.style.top = `${wordRect.bottom}px`;
            setTimeout(() => {
                classificationBox.style.opacity = '1';
                classificationBox.style.transform = 'translate(-50%, 15px) scale(1)';
            }, 10);
        }
        
        function handleClassification(selectedType) {
            if (!selectedWordEl) return;
            
            const correctType = selectedWordEl.dataset.correctType;
            const wordText = selectedWordEl.textContent.trim().replace(/[.,]/g, '');

            reportData.push({
                word: wordText,
                correctClass: correctType,
                chosenClass: selectedType,
                isCorrect: selectedType === correctType
            });

            selectedWordEl.classList.remove('selected');
            selectedWordEl.classList.add('classified', selectedType); // Adiciona a classe da cor selecionada
            
            attemptedWordsCount++;
            if (attemptedWordsCount === totalWordsToClassify) {
                btnAvancar.disabled = false;
            }

            selectedWordEl = null;
            classificationBox.style.display = 'none';
        }

        function generateReport() {
            const reportContainer = document.getElementById('report-container');
            gameContainer.style.display = 'none';
            reportContainer.style.display = 'flex';

            let stats = {
                verbo: { acertos: 0, erros: 0 },
                substantivo: { acertos: 0, erros: 0 },
                adjetivo: { acertos: 0, erros: 0 }
            };

            reportData.forEach(item => {
                if (item.isCorrect) {
                    stats[item.correctClass].acertos++;
                } else {
                    stats[item.correctClass].erros++;
                }
            });

            const tableBody = reportContainer.querySelector("#results-table tbody");
            tableBody.innerHTML = `
                <tr><td>Verbos</td><td class="acertos">${stats.verbo.acertos}</td><td class="erros">${stats.verbo.erros}</td></tr>
                <tr><td>Substantivos</td><td class="acertos">${stats.substantivo.acertos}</td><td class="erros">${stats.substantivo.erros}</td></tr>
                <tr><td>Adjetivos</td><td class="acertos">${stats.adjetivo.acertos}</td><td class="erros">${stats.adjetivo.erros}</td></tr>
            `;

            const reviewList = reportContainer.querySelector('#review-list');
            reviewList.innerHTML = '';
            fichasData.forEach(ficha => {
                let sentenceHTML = ficha.sentence.split(' ').map(wordText => {
                    const cleanWord = wordText.replace(/[.,]/g, '');
                    if (ficha.words[cleanWord]) {
                        const type = ficha.words[cleanWord];
                        return `<span class="word classified ${type}">${wordText}</span>`;
                    }
                    return `<span> ${wordText} </span>`;
                }).join('');
                
                reviewList.innerHTML += `
                    <div class="review-item">
                        <p class="sentence">${sentenceHTML}</p>
                        <p class="explanation">${ficha.explanation}</p>
                    </div>
                `;
            });
        }

        classificationBox.addEventListener('click', (event) => {
            const button = event.target.closest('.class-btn');
            if (button) {
                handleClassification(button.dataset.type);
            }
        });

        btnAvancar.addEventListener('click', () => {
            currentFichaIndex++;
            if (currentFichaIndex < fichasData.length) {
                renderFicha(currentFichaIndex);
            } else {
                generateReport();
            }
        });
        
        renderFicha(currentFichaIndex);
    </script>
</body>
</html>
