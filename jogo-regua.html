<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratório de Medidas</title>
    <style>
        /* Estilo geral com tema moderno e limpo */
        body {
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background-color: #f0f2f5; /* Fundo cinza claro e suave */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
           .back-button {
            position: absolute;
            top: 30px;
            left: 30px;
            font-size: 1.2em;
            color: var(--cor-primaria);
            text-decoration: none;
            font-weight: 700;
            transition: transform 0.3s;
        }

        .back-button:hover {
            transform: scale(1.1);
        }

        /* Container principal com design flat */
        .container {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            text-align: center;
            width: 90%;
            max-width: 800px;
            border: 1px solid #e0e0e0;
            position: relative;
            transition: all 0.3s ease;
        }

        h1 {
            color: #1a237e; /* Azul escuro e moderno */
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        h2 {
            color: #3f51b5; /* Azul índigo */
            font-size: 1.8em;
            margin-top: 0;
            border-bottom: 2px solid #f0f2f5;
            padding-bottom: 10px;
        }

        .hidden { display: none !important; }

        /* --- TELA DE INTRODUÇÃO --- */
        #tela-introducao p {
            font-size: 1.3em;
            color: #555;
        }

        .botoes-modos {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .modo-btn {
            padding: 15px 25px;
            font-size: 1.2em;
            font-weight: bold;
            color: #fff;
            background-color: #3498db; /* Azul vibrante */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }

        .modo-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
            background-color: #2980b9;
        }

        /* --- TELA DO JOGO --- */
        #instrucao {
            font-size: 1.6em;
            color: #0d47a1;
            margin: 20px 0;
            font-weight: bold;
            min-height: 50px;
        }

        /* Área de medida com fundo limpo */
        .area-de-medida {
            position: relative;
            height: 150px;
            margin-top: 20px;
            border: 2px solid #e0e0e0;
            background-color: #f9f9f9;
            border-radius: 8px;
            overflow: hidden; /* Garante que os filhos fiquem dentro das bordas arredondadas */
        }
        
        #objeto-container {
            position: absolute;
            top: 30px; /* Posição ajustada para melhor visualização */
            height: 40px; /* Lápis um pouco mais fino */
        }

        #lapis-svg {
            width: 100%;
            height: 100%;
            display: block;
            filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.15));
        }

        /* Estilos para as partes do lápis SVG */
        #lapis-svg .ponta-lapis { fill: #d1b7a0; } /* Cor de madeira da ponta */
        #lapis-svg .corpo-lapis { fill: #f1c40f; } /* Amarelo vibrante */
        #lapis-svg .grafite-lapis { fill: #333; } /* Grafite escuro */
        #lapis-svg .metal-borracha { fill: #bdc3c7; } /* Metal cinza */
        #lapis-svg .borracha-lapis { fill: #e74c3c; } /* Borracha vermelha */

        /* Resizer invisível na ponta do lápis */
        #resizer {
            width: 30px; /* Área de toque */
            height: 100%;
            position: absolute;
            right: -15px; /* Posicionado na extremidade */
            top: 0;
            cursor: ew-resize;
            z-index: 10;
            /* O resizer agora é invisível */
        }

        /* Régua com visual moderno */
        #regua {
            width: 100%; height: 60px; /* Um pouco mais alta */
            background-color: #ffffff;
            border-top: 2px solid #e0e0e0;
            position: absolute;
            bottom: 0;
            display: flex;
            align-items: flex-end;
            padding: 0 5px;
            box-sizing: border-box;
        }
        
        .tick { position: absolute; bottom: 0; width: 2px; background-color: #555; }
        .tick-cm { height: 30px; }
        .tick-half-cm { height: 18px; background-color: #888; }
        .tick-label { position: absolute; bottom: 35px; font-size: 14px; font-weight: bold; color: #333; transform: translateX(-50%); }

        .controles-jogo {
            margin-top: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        #input-estimativa {
            padding: 10px;
            font-size: 1.5em;
            width: 100px;
            text-align: center;
            border-radius: 8px;
            border: 2px solid #ccc;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        #input-estimativa:focus {
            border-color: #3498db;
            box-shadow: 0 0 8px rgba(52, 152, 219, 0.3);
            outline: none;
        }
        
        #verificarBtn {
            padding: 15px 40px; font-size: 1.5em; font-weight: bold;
            color: white; background-color: #2ecc71; /* Verde para ação positiva */
            border: none; border-radius: 8px; cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
        }
        #verificarBtn:hover {
            background-color: #27ae60;
            transform: scale(1.05);
        }
        
        #voltarBtn {
            position: absolute;
            top: 15px;
            left: 15px;
            padding: 8px 16px; 
            font-size: 1em; 
            background-color: #95a5a6; 
            color: white;
            font-weight: normal;
        }
        #voltarBtn:hover {
            background-color: #7f8c8d;
            box-shadow: none;
            transform: translateY(-2px);
        }


        #feedback { font-size: 2em; font-weight: bold; height: 40px; margin-top: 20px; }
        .correto { color: #2ecc71; }
        .errado { color: #e74c3c; }
    </style>
</head>
<body>
<a href="anos-iniciais.html" class="back-button" title="Voltar ao Portal Principal">‹ Voltar</a>
<div class="container">
    <div id="tela-introducao">
        <h1>Laboratório de Medidas</h1>
        <p>Escolha uma atividade para começar!</p>
        <div class="botoes-modos">
            <button class="modo-btn" data-modo="exato">Tamanho Exato</button>
            <button class="modo-btn" data-modo="estimativa">Qual é a Medida?</button>
            <button class="modo-btn" data-modo="distancia">Qual a Distância?</button>
        </div>
    </div>

    <div id="tela-jogo" class="hidden">
        <button id="voltarBtn" class="modo-btn">Voltar</button>
        <h2 id="titulo-modo">Modo de Jogo</h2>
        <p id="instrucao">Carregando...</p>

        <div class="area-de-medida">
            <div id="objeto-container">
                 <svg id="lapis-svg" viewBox="0 0 250 50" preserveAspectRatio="none">
                    <rect x="25" y="0" width="185" height="50" class="corpo-lapis"/> 
                    <polygon points="210,0 220,0 220,50 210,50" class="metal-borracha"/>
                    <polygon points="220,0 250,0 250,50 220,50" class="borracha-lapis"/>
                    <polygon points="25,0 0,25 25,50" class="ponta-lapis"/>
                    <polygon points="5,20 0,25 5,30" class="grafite-lapis"/>
                </svg>
                <div id="resizer"></div>
            </div>
            <div id="regua"></div>
        </div>

        <div class="controles-jogo">
            <input type="number" id="input-estimativa" class="hidden" placeholder="cm">
            <button id="verificarBtn">Verificar!</button>
        </div>
        
        <p id="feedback"></p>
    </div>
</div>

<script>
    const pixelsPorCm = 25; 
    const maxCm = 30;

    const telaIntroducao = document.getElementById('tela-introducao');
    const telaJogo = document.getElementById('tela-jogo');
    const tituloModoEl = document.getElementById('titulo-modo');
    const instrucaoEl = document.getElementById('instrucao');
    const objetoContainerEl = document.getElementById('objeto-container');
    const resizerEl = document.getElementById('resizer');
    const reguaEl = document.getElementById('regua');
    const verificarBtn = document.getElementById('verificarBtn');
    const inputEstimativaEl = document.getElementById('input-estimativa');
    const feedbackEl = document.getElementById('feedback');
    const voltarBtn = document.getElementById('voltarBtn');
    
    let modoAtual = '';
    let respostaCorreta = 0;

    document.querySelectorAll('.modo-btn[data-modo]').forEach(button => {
        button.addEventListener('click', () => {
            modoAtual = button.getAttribute('data-modo');
            iniciarJogo(modoAtual);
        });
    });

    voltarBtn.addEventListener('click', () => {
        telaJogo.classList.add('hidden');
        telaIntroducao.classList.remove('hidden');
    });

    function iniciarJogo(modo) {
        telaIntroducao.classList.add('hidden');
        telaJogo.classList.remove('hidden');
        gerarRegua();
        novaRodada();
    }

    function novaRodada() {
        feedbackEl.textContent = '';
        feedbackEl.className = '';
        inputEstimativaEl.value = '';
        resizerEl.classList.remove('hidden');
        inputEstimativaEl.classList.add('hidden');
        objetoContainerEl.style.left = '0px';

        if (modoAtual === 'exato') {
            tituloModoEl.textContent = 'Atividade: Tamanho Exato';
            respostaCorreta = Math.floor(Math.random() * 20) + 1;
            instrucaoEl.textContent = `Ajuste o lápis para medir ${respostaCorreta} cm!`;
            objetoContainerEl.style.width = '80px';
        } else if (modoAtual === 'estimativa') {
            tituloModoEl.textContent = 'Atividade: Qual é a Medida?';
            resizerEl.classList.add('hidden');
            inputEstimativaEl.classList.remove('hidden');
            let larguraSorteada = Math.floor(Math.random() * 20) + 2;
            respostaCorreta = larguraSorteada;
            objetoContainerEl.style.width = `${larguraSorteada * pixelsPorCm}px`;
            instrucaoEl.textContent = `Quantos centímetros o lápis mede?`;
        } else if (modoAtual === 'distancia') {
            tituloModoEl.textContent = 'Atividade: Qual a Distância?';
            resizerEl.classList.add('hidden');
            inputEstimativaEl.classList.remove('hidden');
            let inicioCm, tamanhoCm;
            do {
                inicioCm = Math.floor(Math.random() * 20);
                tamanhoCm = Math.floor(Math.random() * 10) + 3;
            } while (inicioCm + tamanhoCm > maxCm - 1);
            respostaCorreta = tamanhoCm;
            objetoContainerEl.style.left = `${inicioCm * pixelsPorCm}px`;
            objetoContainerEl.style.width = `${tamanhoCm * pixelsPorCm}px`;
            instrucaoEl.innerHTML = `Calcule a distância entre o início e o fim do lápis.`;
        }
    }

    function verificarResposta() {
        const larguraAtualEmCm = objetoContainerEl.offsetWidth / pixelsPorCm;
        const chute = parseFloat(inputEstimativaEl.value);

        if (modoAtual === 'exato') {
            if (Math.abs(larguraAtualEmCm - respostaCorreta) < 0.5) {
                feedbackCorreto();
            } else {
                feedbackErrado();
            }
        } else if (modoAtual === 'estimativa' || modoAtual === 'distancia') {
            if (!chute && chute !== 0) {
                feedbackErrado("Digite um número na caixa de resposta.");
                return;
            }
            if (Math.abs(chute - respostaCorreta) < 0.1) {
                feedbackCorreto(`Correto! A resposta era ${respostaCorreta} cm.`);
            } else {
                feedbackErrado("Quase! Calcule novamente com atenção.");
            }
        }
    }

    function feedbackCorreto(mensagem = "Excelente! Resposta correta!") {
        feedbackEl.textContent = mensagem;
        feedbackEl.className = 'correto';
        setTimeout(novaRodada, 2500);
    }

    function feedbackErrado(mensagem = "Ops! Tente de novo.") {
        feedbackEl.textContent = mensagem;
        feedbackEl.className = 'errado';
    }

    function gerarRegua() {
        reguaEl.innerHTML = '';
        for (let cm = 0; cm <= maxCm; cm++) {
            const posicao = cm * pixelsPorCm;
            const tickEl = document.createElement('div');
            tickEl.className = 'tick tick-cm';
            tickEl.style.left = `${posicao}px`;
            const labelEl = document.createElement('span');
            labelEl.className = 'tick-label';
            labelEl.textContent = cm;
            labelEl.style.left = `${posicao}px`;
            reguaEl.appendChild(tickEl);
            reguaEl.appendChild(labelEl);
            if (cm < maxCm) {
                const halfTickEl = document.createElement('div');
                halfTickEl.className = 'tick tick-half-cm';
                halfTickEl.style.left = `${posicao + (pixelsPorCm / 2)}px`;
                reguaEl.appendChild(halfTickEl);
            }
        }
    }

    resizerEl.addEventListener('mousedown', function(e) {
        if (resizerEl.classList.contains('hidden')) return;
        e.preventDefault();
        const startX = e.clientX;
        const startWidth = objetoContainerEl.offsetWidth;
        function aoArrastar(e) {
            const novaLargura = startWidth + (e.clientX - startX);
            if (novaLargura > 20) {
                objetoContainerEl.style.width = `${novaLargura}px`;
            }
        }
        function aoSoltar() {
            document.removeEventListener('mousemove', aoArrastar);
            document.removeEventListener('mouseup', aoSoltar);
        }
        document.addEventListener('mousemove', aoArrastar);
        document.addEventListener('mouseup', aoSoltar);
    });

    verificarBtn.addEventListener('click', verificarResposta);
    inputEstimativaEl.addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
            verificarResposta();
        }
    });

</script>
</body>
</html>

