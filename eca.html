<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio ECA: Nível Avançado (Versão Estável)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap');

        /* --- Variáveis CSS para Cores e Estilos --- */
        :root {
            --cor-primaria: #4A90E2; /* Azul vibrante */
            --cor-secundaria: #6B7B8F; /* Cinza azulado */
            --cor-sucesso: #7ED321; /* Verde limão */
            --cor-perigo: #D0021B; /* Vermelho intenso */
            --cor-fundo: #E8F0F7; /* Azul claro de fundo */
            --cor-texto-principal: #333333;
            --cor-texto-claro: #FFFFFF;
            --sombra-leve: 0 4px 15px rgba(0, 0, 0, 0.1);
            --sombra-intensa: 0 10px 30px rgba(0, 0, 0, 0.2);

            --time1-bg: #FF6B6B; /* Vermelho claro */
            --time2-bg: #4ECDC4; /* Azul esverdeado */
            --time3-bg: #FFC107; /* Amarelo ouro */

            --ouro: #FFD700;
            --prata: #C0C0C0;
            --bronze: #CD7F32;
        }

        /* --- Reset Básico e Fontes --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            height: 100%;
            font-family: 'Montserrat', sans-serif;
            color: var(--cor-texto-principal);
            overflow: hidden; /* Evita qualquer barra de rolagem */
        }

        body {
            background-color: var(--cor-fundo);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background-color: var(--cor-texto-claro);
            border-radius: 25px;
            box-shadow: var(--sombra-intensa);
            padding: 30px 40px;
            width: 100%;
            max-width: 1280px;
            height: 95%;
            display: flex;
            flex-direction: column;
            text-align: center;
        }

        header {
            margin-bottom: 20px;
            flex-shrink: 0;
        }
        header h1 {
            color: var(--cor-primaria);
            font-size: 2.8em;
            font-weight: 800;
            margin-bottom: 5px;
            letter-spacing: -1px;
        }
        header p {
            font-size: 1.1em;
            color: var(--cor-secundaria);
        }

        /* --- Botões de Controle --- */
        .btn-controle {
            background-color: var(--cor-primaria);
            color: var(--cor-texto-claro);
            border: none;
            padding: 14px 35px;
            font-size: 1.15em;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--sombra-leve);
            margin-top: 20px;
        }
        .btn-controle:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }
        
        /* --- Telas Escondidas/Visíveis --- */
        #tela-inicial, #tela-final { display: block; flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center;}
        .painel-jogo { display: none; flex-grow: 1; flex-direction: column; }


        /* --- TELA INICIAL --- */
        #tela-inicial h2 {
            font-size: 2.2em;
            margin-bottom: 25px;
            font-weight: 700;
        }
        #tela-inicial .instrucoes {
            border-left: 5px solid var(--cor-primaria);
            padding: 20px;
            max-width: 700px;
            margin: 20px auto 40px auto;
            text-align: left;
            line-height: 1.7;
            font-size: 1.05em;
        }
        .cadastro-times {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        .cadastro-times input[type="text"] {
            padding: 12px 15px;
            border-radius: 10px;
            font-size: 1.1em;
            text-align: center;
            width: 200px;
            border: 2px solid #ccc;
        }
        
        /* --- PAINEL DE JOGO --- */
        #jogo-container {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            min-height: 0;
        }

        #info-superior {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 15px;
            padding: 12px 25px;
            margin-bottom: 20px;
            background-color: #f0f8ff;
            box-shadow: var(--sombra-leve);
        }
        .identificador-time {
            padding: 8px 15px;
            border-radius: 8px;
            color: var(--cor-texto-claro);
            font-size: 1.1em;
            font-weight: 700;
        }
        
        #jogo-principal {
            display: grid;
            grid-template-columns: 3fr 4fr;
            gap: 30px;
            flex-grow: 1;
            min-height: 0;
        }

        #pergunta-container {
            border-radius: 18px;
            padding: 25px;
            background-color: var(--cor-fundo);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #pergunta-texto {
            font-size: 1.7em;
            font-weight: 700;
        }

        #interacao-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        #painel-registro {
            padding: 15px 20px;
            border-radius: 15px;
            background-color: #fff;
            border: 1px solid #e0eaf3;
            box-shadow: var(--sombra-leve);
        }
        .botoes-selecao-time {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        .btn-time-selecionar {
            padding: 10px 18px;
            font-size: 0.95em;
            border-radius: 8px;
            border: 2px solid;
            font-weight: 600;
            cursor: pointer;
        }
        
        .opcoes-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            flex-grow: 1;
        }
        .btn-opcao {
            padding: 18px;
            font-size: 1.05em;
            border-radius: 12px;
            background-color: var(--cor-primaria);
            color: var(--cor-texto-claro);
            font-weight: 600;
            cursor: pointer;
            border: none;
        }

        #feedback-container {
            padding: 25px;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: left;
        }
        
        #controles-finais {
            padding-top: 20px;
            gap: 20px;
            display: flex;
            justify-content: center;
        }

        /* --- TELA FINAL (Pódio) --- */
        #tela-final {
            display: none;
        }
        #tela-final h2 {
            font-size: 2.5em;
            margin-bottom: 25px;
            color: var(--cor-primaria);
            font-weight: 800;
        }

        .podio-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 20px;
            height: 250px;
            margin: 30px auto 40px auto;
        }

        .podio-item {
            padding: 20px 15px;
            border-radius: 15px 15px 0 0;
            width: 180px;
            animation: fadeInScale 0.8s ease-out forwards;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.8) translateY(50px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .podio-rank, .podio-nome, .podio-pontos {
            color: var(--cor-texto-principal);
            text-shadow: none;
        }

        .primeiro-lugar { height: 200px; background-color: var(--ouro); order: 2; animation-delay: 0.2s; }
        .segundo-lugar { height: 160px; background-color: var(--prata); order: 1; animation-delay: 0s; }
        .terceiro-lugar { height: 120px; background-color: var(--bronze); order: 3; animation-delay: 0.4s; }
        .terceiro-lugar .podio-rank, .terceiro-lugar .podio-nome, .terceiro-lugar .podio-pontos { color: var(--cor-texto-claro); }
        
        .resumo-container {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 40px;
        }
        .resumo-time {
            padding: 20px;
            border: 3px solid;
            border-radius: 15px;
            width: 30%;
            min-width: 250px;
        }
        
        .btn-time-selecionar.selecionado { transform: translateY(-3px) scale(1.05); box-shadow: 0 6px 15px rgba(0,0,0,0.2); border-width: 4px; }
        .btn-opcao.correta { background-color: var(--cor-sucesso); animation: pulseGreen 1s ease-out; }
        .btn-opcao.errada { background-color: var(--cor-perigo); animation: shakeRed 0.5s ease-out; }
        .btn-opcao:disabled { cursor: not-allowed; opacity: 0.7; }
    </style>
</head>
<body>

    <div class="container">
        
        <div id="tela-inicial">
            <header>
                <h1>Desafio ECA</h1>
                <p>Nível Avançado: Direitos e Deveres do Cidadão Mirim</p>
            </header>
            <div class="instrucoes">
                <p>1. A turma é dividida em <strong>3 times</strong> com nomes personalizados.</p>
                <p>2. A cada pergunta, os times debatem e escolhem uma única resposta.</p>
                <p>3. Professor(a), **selecione o(s) time(s)** e clique na opção escolhida.</p>
                <p>4. O placar ficará <strong>secreto</strong>! A grande revelação será no pódio final.</p>
            </div>
            <div class="cadastro-times">
                 <div><label for="time1-nome">Time 1</label><input type="text" id="time1-nome" value="Guardiões do ECA"></div>
                 <div><label for="time2-nome">Time 2</label><input type="text" id="time2-nome" value="Cidadãos do Amanhã"></div>
                 <div><label for="time3-nome">Time 3</label><input type="text" id="time3-nome" value="Defensores da Lei"></div>
            </div>
            <button class="btn-controle" id="btn-iniciar">Começar o Desafio!</button>
        </div>

        <div class="painel-jogo" id="painel-jogo">
            <div id="jogo-container">
                <div id="info-superior">
                    <div id="identificadores-times" style="display: flex; gap: 10px;"></div>
                    <div id="contador-pergunta"></div>
                </div>
                <div id="jogo-principal">
                    <div id="pergunta-container"><p id="pergunta-texto"></p></div>
                    <div id="interacao-container"></div>
                </div>
                <div id="controles-finais">
                     <button class="btn-controle" id="btn-revelar" style="display: none;">Revelar Resposta</button>
                     <button class="btn-controle" id="btn-proxima" style="display: none;">Próxima Pergunta</button>
                </div>
            </div>
        </div>
        
        <div id="tela-final">
            <header>
                <h2>Resultado Final: O Pódio do Conhecimento!</h2>
            </header>
            <div id="resultado-final-container"></div>
            <button class="btn-controle" id="btn-reiniciar">Jogar Novamente</button>
        </div>
    </div>

    <script>
        // --- NOVO BANCO DE DADOS DE PERGUNTAS COMPLEXAS ---
        const perguntas = [
            { pergunta: "O ECA afirma que é 'dever da família, da comunidade, da sociedade em geral e do poder público' assegurar os direitos da criança. O que isso significa na prática?", opcoes: ["Apenas os pais são responsáveis pela criança.", "A responsabilidade é compartilhada por todos na sociedade.", "Apenas o governo deve cuidar das crianças.", "A escola é a única responsável após a família."], resposta: 1, explicacao: "A responsabilidade é de todos! Se um vizinho, um professor ou qualquer cidadão vê um direito sendo violado, ele também tem o dever de proteger a criança." },
            { pergunta: "O direito ao 'respeito' inclui a inviolabilidade da integridade física, psíquica e moral. Qual situação VIOLA diretamente esse direito?", opcoes: ["Receber um castigo de ficar sem videogame por não fazer a lição.", "Ser alvo de apelidos ofensivos e humilhantes pelos colegas.", "Ter hora para dormir definida pelos pais.", "Ajudar a arrumar a mesa depois do jantar."], resposta: 1, explicacao: "Apelidos ofensivos (bullying) atacam a integridade psíquica e moral da pessoa, sendo uma clara violação do direito ao respeito." },
            { pergunta: "Se uma criança é afastada de seus pais por decisão judicial, qual é a prioridade segundo o ECA?", opcoes: ["Ser enviada imediatamente para adoção por qualquer família.", "Permanecer em um abrigo até completar 18 anos.", "Ser, preferencialmente, acolhida por um parente próximo (família extensa).", "Morar com a família do seu melhor amigo da escola."], resposta: 2, explicacao: "O ECA prioriza manter os laços familiares. Por isso, a primeira opção é sempre buscar avós, tios ou outros parentes para cuidar da criança." },
            { pergunta: "Uma criança precisa de um tratamento médico muito caro que sua família não pode pagar. A quem a família deve recorrer para garantir o direito à saúde?", opcoes: ["A uma ONG internacional, pois o Brasil não cobre esses custos.", "Apenas a um plano de saúde particular.", "Ao poder público (Estado), que tem o dever de fornecer o tratamento pelo SUS.", "A uma 'vaquinha' na internet, pois é a única solução."], resposta: 2, explicacao: "O direito à saúde é um dever do Estado. Mesmo que o tratamento seja caro, a família pode e deve exigi-lo do poder público através do SUS." },
            { pergunta: "O ECA garante o direito à profissionalização. A partir de que idade um adolescente pode trabalhar legalmente como 'Jovem Aprendiz'?", opcoes: ["A partir dos 12 anos, em qualquer serviço.", "A partir dos 16 anos, em qualquer horário.", "A partir dos 14 anos, em um programa de aprendizagem.", "A partir dos 18 anos, quando se torna adulto."], resposta: 2, explicacao: "A lei permite o trabalho protegido na condição de aprendiz a partir dos 14 anos, garantindo direitos e que o estudo não seja prejudicado." },
            { pergunta: "O Conselho Tutelar é um órgão fundamental na proteção dos direitos. Qual das situações abaixo é uma atribuição principal do Conselho Tutelar?", opcoes: ["Julgar e prender pais que cometem crimes contra os filhos.", "Matricular crianças na escola particular e pagar a mensalidade.", "Aplicar medidas de proteção, como incluir a criança em programas de auxílio.", "Substituir o papel dos pais na educação diária."], resposta: 2, explicacao: "O Conselho Tutelar não julga crimes (isso é papel do Juiz), mas age para proteger, aconselhando e encaminhando a criança e a família para serviços de apoio." },
            { pergunta: "Um adolescente de 15 anos criou um perfil falso na internet para ofender um professor. Ele tem direito à liberdade de expressão, mas qual o limite nesse caso?", opcoes: ["Nenhum, a internet é livre e ele pode se expressar como quiser.", "A liberdade de expressão termina quando viola o direito à honra e à imagem de outra pessoa.", "Ele só estaria errado se usasse o nome verdadeiro no perfil.", "Ele só pode ser punido se o professor provar que ficou triste."], resposta: 1, explicacao: "Nenhum direito é absoluto. A liberdade de expressão é garantida, mas não pode ser usada para cometer crimes, como difamação e calúnia." },
            { pergunta: "Uma criança com deficiência física tem direito à educação. O que o ECA exige da escola para garantir esse direito?", opcoes: ["Que a criança estude em uma sala separada para não atrapalhar os outros.", "Que a escola forneça rampas, banheiros adaptados e atendimento educacional especializado.", "Que os pais paguem uma taxa extra para cobrir os custos da adaptação.", "Que a criança tenha notas mais altas que os outros para poder permanecer na escola."], resposta: 1, explicacao: "O direito à educação inclusiva exige que a escola se adapte para receber o aluno, oferecendo acessibilidade e suporte pedagógico especializado." },
            { pergunta: "Um adolescente de 16 anos comete um 'ato infracional' (ação descrita como crime). Qual a diferença fundamental entre a punição dele e a de um adulto?", opcoes: ["Não há diferença, ambos recebem a mesma pena e vão para a mesma prisão.", "O adolescente não pode ser responsabilizado, apenas seus pais.", "O adolescente recebe uma 'medida socioeducativa', com foco na reeducação, e não uma 'pena'.", "O adolescente pode escolher entre ir para a cadeia ou pagar uma multa."], resposta: 2, explicacao: "O objetivo para o adolescente não é a punição (pena), mas a reeducação e a reintegração social. Por isso, ele cumpre uma medida socioeducativa." },
            { pergunta: "O ECA fala sobre o 'melhor interesse da criança'. Em uma disputa de guarda entre os pais, o que esse princípio significa?", opcoes: ["Que a criança ficará com o pai ou a mãe que tiver mais dinheiro.", "Que a decisão do juiz deve ser baseada no que é mais saudável e seguro para o desenvolvimento da criança.", "Que a criança tem o poder de decidir sozinha com quem quer morar, sem a opinião de mais ninguém.", "Que a guarda será sempre compartilhada, mesmo que um dos pais represente um risco."], resposta: 1, explicacao: "O juiz analisará todos os fatores (afeto, segurança, rotina) para decidir o que será melhor para o bem-estar e desenvolvimento integral da criança." },
            { pergunta: "O ECA foca em direitos, mas também pressupõe deveres. Qual é o dever correspondente ao direito de ter uma escola limpa e organizada?", opcoes: ["Exigir que a escola contrate mais faxineiros.", "Faltar no dia da limpeza para não atrapalhar.", "Colaborar para manter a limpeza, jogando lixo no lixo e não depredando o patrimônio.", "Limpar a sala inteira sozinho todos os dias."], resposta: 2, explicacao: "O direito a um ambiente limpo vem com o dever de ajudar a mantê-lo assim, respeitando o espaço que é de todos." },
            { pergunta: "O dever de 'respeitar pais e responsáveis' significa que a criança ou adolescente deve...", opcoes: ["Concordar com absolutamente tudo que eles dizem, sem questionar.", "Acatar as regras e orientações definidas para sua proteção e educação.", "Nunca contar a ninguém se estiver sofrendo violência em casa.", "Fazer todas as tarefas domésticas sem ajuda."], resposta: 1, explicacao: "Respeitar envolve ouvir e seguir as orientações dadas para o seu bem-estar, mesmo que você não concorde com elas no momento." },
            { pergunta: "Ao ter acesso à educação, qual é um dos principais deveres do estudante?", opcoes: ["Apenas comparecer à escola para garantir a presença.", "Dedicar-se aos estudos e cumprir as tarefas propostas.", "Ensinar o conteúdo para o professor.", "Passar de ano sem precisar aprender o conteúdo."], resposta: 1, explicacao: "O direito à educação é uma oportunidade que deve ser valorizada com o dever de se esforçar para aprender e evoluir." },
            { pergunta: "O dever de preservar os espaços públicos se aplica quando você está...", opcoes: ["Apenas dentro da sua casa.", "Em uma praça, parque ou biblioteca pública.", "Apenas na escola, porque é obrigatório.", "Em um shopping, porque é um lugar privado."], resposta: 1, explicacao: "Espaços públicos pertencem a toda a comunidade. É nosso dever cuidar deles para que todos possam usar." },
            { pergunta: "Um colega tem dificuldade em uma matéria. Se você sabe o conteúdo, qual atitude demonstra um dever de convivência e solidariedade?", opcoes: ["Rir da dificuldade dele.", "Oferecer ajuda para explicar a matéria.", "Fazer o trabalho dele para ele não ficar com nota baixa.", "Ignorar, pois o problema não é seu."], resposta: 1, explicacao: "Ajudar um colega a entender, sem fazer o trabalho por ele, é uma atitude que fortalece a todos e cria um ambiente escolar melhor." },
            { pergunta: "Um adolescente de 14 anos quer ir a uma festa que seus pais o proibiram de ir por ser tarde e perigosa. Se ele for escondido, qual dever ele está descumprindo?", opcoes: ["O dever de se divertir, pois ele está indo à festa.", "O dever de obediência e respeito à autoridade e cuidado dos pais.", "O dever de ser popular na escola.", "O dever de ser independente e tomar as próprias decisões."], resposta: 1, explicacao: "As regras impostas pelos pais visam a proteção. Desobedecer a uma regra de segurança é desrespeitar o cuidado que eles têm com você." },
            { pergunta: "Durante um trabalho em grupo na escola, um dos membros não faz sua parte. Qual é o dever dos outros integrantes?", opcoes: ["Fazer a parte dele e não falar nada para não criar confusão.", "Excluir o nome dele do trabalho na hora de entregar.", "Conversar com ele sobre a importância da colaboração e, se não resolver, comunicar o professor.", "Deixar de fazer o trabalho também, em protesto."], resposta: 2, explicacao: "O dever do grupo é primeiro tentar resolver o problema com diálogo e, se não for possível, buscar a mediação do professor, que é a autoridade responsável." },
            { pergunta: "Você recebe uma notícia chocante pelo WhatsApp. Qual é seu dever antes de compartilhar com todos os seus amigos?", opcoes: ["Compartilhar o mais rápido possível para ser o primeiro a contar.", "Verificar se a informação é verdadeira, para não espalhar 'fake news'.", "Enviar apenas para os melhores amigos.", "Acreditar na notícia imediatamente, especialmente se tiver uma imagem."], resposta: 1, explicacao: "Espalhar notícias falsas (fake news) é uma irresponsabilidade que pode prejudicar muitas pessoas. Nosso dever é checar a informação antes de repassar." },
            { pergunta: "Um adolescente participa do grêmio estudantil. Eles querem organizar um protesto para pedir melhorias na estrutura da escola. Qual é o dever do grêmio ao organizar esse evento?", opcoes: ["Quebrar algumas carteiras para mostrar que a estrutura está ruim.", "Organizar o protesto de forma pacífica, respeitando o direito dos outros e comunicando a direção.", "Fazer o protesto durante a aula de um professor de que não gostam para atrapalhá-lo.", "Cancelar as aulas por conta própria, pois o grêmio tem esse poder."], resposta: 1, explicacao: "O direito à manifestação deve ser exercido com o dever de respeitar as pessoas e o patrimônio. A organização pacífica é a forma correta de reivindicar." },
            { pergunta: "O ECA protege o adolescente que comete um ato infracional. No entanto, qual é o dever desse adolescente perante a sociedade após cumprir a medida socioeducativa?", opcoes: ["Nenhum, pois a medida já quitou sua dívida e ele pode fazer o que quiser.", "Contar para todo mundo o que fez para se tornar popular.", "Mudar de cidade para que ninguém nunca saiba o que aconteceu.", "Refletir sobre seu ato e se reintegrar à sociedade de forma responsável e respeitosa."], resposta: 3, explicacao: "A medida socioeducativa serve para a reflexão. O dever do adolescente é usar essa oportunidade para se tornar um cidadão melhor e mais consciente de seus atos." }
        ];
        
        const telaInicial = document.getElementById('tela-inicial');
        const painelJogo = document.getElementById('painel-jogo');
        const telaFinal = document.getElementById('tela-final');
        const resultadoFinalContainer = document.getElementById('resultado-final-container');
        const btnIniciar = document.getElementById('btn-iniciar');
        const btnRevelar = document.getElementById('btn-revelar');
        const btnProxima = document.getElementById('btn-proxima');
        const btnReiniciar = document.getElementById('btn-reiniciar');
        const identificadoresTimesEl = document.getElementById('identificadores-times');
        const contadorPerguntaEl = document.getElementById('contador-pergunta');
        const perguntaTextoEl = document.getElementById('pergunta-texto');
        const interacaoContainer = document.getElementById('interacao-container');
        const NUM_TIMES = 3;
        let nomesDosTimes = [], pontuacoes = [], acertosPorTime = [], perguntaAtualIndex, timesSelecionados = [], respostasDosTimesNaRodada = [];

        function criarConteudoInteracao() { return `<div id="painel-registro"><p>1º: Selecione o(s) time(s). 2º: Clique na resposta escolhida.</p><div class="botoes-selecao-time" id="botoes-selecao-time"></div></div><div class="opcoes-grid" id="opcoes-container"></div>`; }

        function iniciarJogo() {
            nomesDosTimes = [ document.getElementById('time1-nome').value, document.getElementById('time2-nome').value, document.getElementById('time3-nome').value ];
            pontuacoes = Array(NUM_TIMES).fill(0);
            acertosPorTime = Array(NUM_TIMES).fill(0);
            perguntaAtualIndex = 0;
            telaInicial.style.display = 'none'; telaFinal.style.display = 'none'; painelJogo.style.display = 'flex';
            montarInfoSuperior();
            mostrarPergunta();
        }

        function mostrarPergunta() {
            resetarEstadoDaRodada();
            const perguntaAtual = perguntas[perguntaAtualIndex];
            contadorPerguntaEl.textContent = `Pergunta ${perguntaAtualIndex + 1} / ${perguntas.length}`;
            perguntaTextoEl.textContent = perguntaAtual.pergunta;
            const botoesSelecaoTimeEl = document.getElementById('botoes-selecao-time');
            nomesDosTimes.forEach((nome, index) => {
                const button = document.createElement('button');
                button.innerText = nome;
                button.className = 'btn-time-selecionar'; button.id = `btn-selecionar-${index}`;
                button.style.backgroundColor = `var(--time${index + 1}-cor)`;
                button.style.borderColor = `var(--time${index + 1}-cor)`;
                button.addEventListener('click', () => toggleSelecaoTime(index));
                botoesSelecaoTimeEl.appendChild(button);
            });
            const opcoesContainer = document.getElementById('opcoes-container');
            perguntaAtual.opcoes.forEach((opcao, index) => {
                const button = document.createElement('button');
                button.innerText = opcao; button.className = 'btn-opcao';
                button.addEventListener('click', () => registrarRespostaParaTimes(index));
                opcoesContainer.appendChild(button);
            });
        }
        
        function registrarRespostaParaTimes(opcaoIndex) { 
            if (timesSelecionados.length === 0) { alert("Selecione um time antes de registrar a resposta."); return; } 
            timesSelecionados.forEach(timeIndex => { 
                respostasDosTimesNaRodada[timeIndex] = opcaoIndex; 
                const btnTime = document.getElementById(`btn-selecionar-${timeIndex}`); 
                btnTime.disabled = true; 
                btnTime.innerText = `${nomesDosTimes[timeIndex]} - OK!`; 
            }); 
            timesSelecionados = []; 
            document.querySelectorAll('.btn-time-selecionar.selecionado').forEach(btn => btn.classList.remove('selecionado')); 
            if (respostasDosTimesNaRodada.filter(r => r !== null).length === NUM_TIMES) { 
                btnRevelar.style.display = 'inline-block'; 
            } 
        }

        function revelarRespostas() { 
            btnRevelar.style.display = 'none'; 
            const perguntaAtual = perguntas[perguntaAtualIndex]; 
            const respostaCorreta = perguntaAtual.resposta; 
            for (let i = 0; i < NUM_TIMES; i++) { 
                if (respostasDosTimesNaRodada[i] === respostaCorreta) { 
                    pontuacoes[i] += 10; 
                    acertosPorTime[i] += 1;
                } 
            } 
            document.querySelectorAll('.btn-opcao').forEach((btn, index) => { 
                btn.disabled = true; 
                if (index === respostaCorreta) btn.classList.add('correta'); 
                else if (respostasDosTimesNaRodada.includes(index)) btn.classList.add('errada'); 
            }); 
            
            const acertos = respostasDosTimesNaRodada.filter(r => r === respostaCorreta).length;
            const textoRespostaCorreta = perguntaAtual.opcoes[respostaCorreta];
            let tituloFeedback = '', classeFeedback = '';
            
            if (acertos === NUM_TIMES) { tituloFeedback = 'Parabéns a todos! Resposta Correta!'; classeFeedback = 'feedback-sucesso'; }
            else if (acertos > 0) { tituloFeedback = 'Bom debate! Vamos analisar a resposta.'; classeFeedback = 'feedback-aviso'; }
            else { tituloFeedback = 'Essa foi desafiadora! Vamos aprender juntos.'; classeFeedback = 'feedback-erro'; }

            interacaoContainer.innerHTML = `<div id="feedback-container" class="${classeFeedback}"><h3 style="margin-top: 0;">${tituloFeedback}</h3><p>A resposta correta é: <strong>"${textoRespostaCorreta}"</strong>.</p><p><strong>Por quê?</strong> ${perguntaAtual.explicacao}</p></div>`; 
            
            if (perguntas.length > perguntaAtualIndex + 1) { 
                btnProxima.style.display = 'inline-block'; 
            } else { 
                setTimeout(mostrarTelaFinal, 5000); 
            } 
        }
        
        function proximaPergunta() { 
            perguntaAtualIndex++; 
            mostrarPergunta(); 
        }

        function mostrarTelaFinal() {
            painelJogo.style.display = 'none';
            telaFinal.style.display = 'block';
            resultadoFinalContainer.innerHTML = '';
            
            const timesComDados = nomesDosTimes.map((nome, index) => ({
                nome: nome,
                pontuacao: pontuacoes[index],
                cor: `var(--time${index + 1}-cor)`,
                acertos: acertosPorTime[index]
            }));

            const timesOrdenados = [...timesComDados].sort((a, b) => b.pontuacao - a.pontuacao);

            let podioHTML = '<div class="podio-container">';
            const classesPodio = ['primeiro-lugar', 'segundo-lugar', 'terceiro-lugar'];
            const ranksPodio = ['1º Lugar', '2º Lugar', '3º Lugar'];
            timesOrdenados.forEach((time, index) => {
                podioHTML += `<div class="podio-item ${classesPodio[index]}"><div class="podio-rank">${ranksPodio[index]}</div><div class="podio-nome">${time.nome}</div><div class="podio-pontos">${time.pontuacao} pts</div></div>`;
            });
            podioHTML += '</div>';

            let resumoHTML = '<h2>Resumo do Desempenho</h2><div class="resumo-container">';
            timesComDados.forEach(time => {
                const aproveitamento = ((time.acertos / perguntas.length) * 100).toFixed(0);
                resumoHTML += `<div class="resumo-time" style="border-color: ${time.cor};"><h3 style="color: ${time.cor};">${time.nome}</h3><p><strong>Pontuação Final:</strong> ${time.pontuacao}</p><p><strong>Respostas Corretas:</strong> ${time.acertos} de ${perguntas.length}</p><p><strong>Aproveitamento:</strong> ${aproveitamento}%</p></div>`;
            });
            resumoHTML += '</div>';

            resultadoFinalContainer.innerHTML = podioHTML + resumoHTML;
        }

        function montarInfoSuperior() {
            identificadoresTimesEl.innerHTML = '';
            for (let i = 0; i < NUM_TIMES; i++) {
                const divId = document.createElement('div');
                divId.className = 'identificador-time';
                divId.textContent = nomesDosTimes[i];
                divId.style.backgroundColor = `var(--time${i + 1}-cor)`;
                identificadoresTimesEl.appendChild(divId);
            }
        }
        
        function resetarEstadoDaRodada() {
            timesSelecionados = [];
            respostasDosTimesNaRodada = Array(NUM_TIMES).fill(null);
            interacaoContainer.innerHTML = criarConteudoInteracao();
            btnRevelar.style.display = 'none';
            btnProxima.style.display = 'none';
        }

        function toggleSelecaoTime(timeIndex) {
            const btn = document.getElementById(`btn-selecionar-${timeIndex}`);
            const indexNoArray = timesSelecionados.indexOf(timeIndex);
            if (indexNoArray > -1) {
                timesSelecionados.splice(indexNoArray, 1);
                btn.classList.remove('selecionado');
            } else {
                timesSelecionados.push(timeIndex);
                btn.classList.add('selecionado');
            }
        }
        
        btnIniciar.addEventListener('click', iniciarJogo);
        btnRevelar.addEventListener('click', revelarRespostas);
        btnProxima.addEventListener('click', proximaPergunta);
        btnReiniciar.addEventListener('click', () => {
            telaFinal.style.display = 'none';
            telaInicial.style.display = 'block';
        });
    </script>
</body>
</html>
